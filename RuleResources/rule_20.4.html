<!-- rule_20.4.html
copyright: &copy; 2013 Programming Research
   module: M2CM-3.2-QAC-8.1.2
  purpose: MISRA-C:2004 Rules explanation file
  history: auto-created on 30-Jul-13
-->
<!--
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
-->
<HTML><HEAD><TITLE>QA C Help - Rule 20.4</TITLE>
         <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
         <meta http-equiv="Content-Style-Type" content="text/css">
         <link href="css/message.css" rel="stylesheet" type="text/css">
</HEAD><BODY>
<table class="heading">
<tr class="heading">
<td class="heading" rowspan=4 width="85px"><img src="QAC.png"></td>
<td class="heading" align="right" width="11px">
<a href="rule_20.3.html"><img src="left.png" alt="[previous]"></a>
</td>
<td class="heading_number"><span style="white-space:nowrap">MISRA-C:2004&nbsp;&nbsp;Rule&nbsp;&nbsp;20.4:&nbsp;&nbsp;(Required)</span></td>
<td class="heading" align="left" width="11px">
<a href="rule_20.5.html"><img src="right.png" alt="[next]"></a>
</td>
<td class="heading"/>
<td class="heading_message">Dynamic heap memory allocation shall not be used.</td>
<tr class="heading">
<td class="heading" height="1px" colspan=7 background="prqa_sep.png"/><td class="heading" width="76px"><img src="prqa_right.png"/></td></tr>
<tr class="heading">
<td colspan=4  class="heading_category"></td>
<td width="70%" class="heading_verbose"/>
<td class="heading_message"/>
</tr>
</table>
This precludes the use of the functions calloc, malloc, realloc and free.
<P>
There is a whole range of unspecified, undefined and implementation-defined behaviour associated with dynamic memory allocation, as well as a number of other potential pitfalls.  Dynamic heap memory allocation may lead to memory leaks, data inconsistency, memory exhaustion, non-deterministic behaviour.
<P>
Note that some implementations may use dynamic heap memory allocation to implement other functions (for example functions in the library string.h).  If this is the case then these functions shall also be avoided.<P>
<P><FONT SIZE=+1><B>Example Code:</B></FONT>
<PRE>
<code>
<pre class="example"><code class="comment">&#x2F;&#x2A; PRQA S 2983 &#x2B;&#x2B; &#x2A;&#x2F;</code>

<code class="preprocessor">#include</code><code class="string"> &lt;stdlib.h&gt;</code>
<code class="preprocessor">#include</code><code class="string"> "misra.h"</code>
<code class="preprocessor">#include</code><code class="string"> "m2cmex.h"</code>

<code class="preprocessor">#define L 4U</code>

<code class="keyword">extern</code> S16 test_2004<code class="operator">&#x28;</code> <code class="type">void</code> <code class="operator">&#x29;</code>
<code class="operator">&#x7B;</code>
   S8 <code class="operator">&#x2A;</code>p;

   p <code class="operator">&#x3D;</code> <code class="operator">&#x28;</code> S8 <code class="operator">&#x2A;</code> <code class="operator">&#x29;</code>malloc<code class="operator">&#x28;</code> L <code class="operator">&#x29;</code>;<code class="comment">                &#x2F;&#x2A; MISRA Violation &#x2A;&#x2F;</code>
   free<code class="operator">&#x28;</code> p <code class="operator">&#x29;</code>;<code class="comment">                              &#x2F;&#x2A; MISRA Violation &#x2A;&#x2F;</code>

   p <code class="operator">&#x3D;</code> <code class="operator">&#x28;</code> S8 <code class="operator">&#x2A;</code> <code class="operator">&#x29;</code>calloc<code class="operator">&#x28;</code> <code class="number">10U</code>, L <code class="operator">&#x29;</code>;<code class="comment">           &#x2F;&#x2A; MISRA Violation &#x2A;&#x2F;</code>
   p <code class="operator">&#x3D;</code> <code class="operator">&#x28;</code> S8 <code class="operator">&#x2A;</code> <code class="operator">&#x29;</code>realloc<code class="operator">&#x28;</code> p, L <code class="operator">&#x29;</code>;<code class="comment">            &#x2F;&#x2A; MISRA Violation &#x2A;&#x2F;</code>

   <code class="keyword">return</code> <code class="number">0</code>;
<code class="operator">&#x7D;</code>


</pre>
</code>
</PRE>
<P><HR><P>
<B>QAC messages that encompass this guideline:</B>
<P>
<TABLE WIDTH="90%" BORDER=1 CELLSPACING=0 >
<TR>
<TD VALIGN=TOP WIDTH="10%" ALIGN=CENTER> <A HREF="5118.html">5118</A></TD>
<TD VALIGN=TOP WIDTH="90%"> Dynamic heap memory allocation shall not be used. </TD>
</TR>
</TABLE>
<P><HR>
<TABLE WIDTH="100%">
<TR>
<TD WIDTH="355px">
<IMG SRC="prqa_left.png"/>
</TD>
<TD COLSPAN=2 BACKGROUND="prqa_middle.png"/>
</TR>
</TABLE>
<P>
<BR><I><A HREF="misra.html">(c)  The Motor Industry Research Association, 2004</A></I>
<TABLE WIDTH="100%">
  <TR VALIGN="MIDDLE">
    <TD WIDTH="30%">
      <I><B>QA C Source Code Analyser 8.1.2</B></I>
      <BR><I><B>MISRA-C:2004 Compliance Module 3.2</B></I>
      <BR><I>&copy; 2013 Programming Research</I>
      <BR><I>
        www.programmingresearch.com
      </I>
    </TD>
    <TD ALIGN="CENTER" WIDTH="60%">
      <A HREF="PersonIndex.html">Personality Groups</A> | 
      <A HREF="Glossary.html">Glossary</A> | 
      <A HREF="MessageIndex.html">Message Index</A>
      | <A HREF="MISRA-C_2004Index.html">MISRA-C:2004 Rule Index</A>
    </TD>
    <TD ALIGN="RIGHT" WIDTH="10%">
      <A HREF="messages.htm">Contents</A>
    </TD>
  </TR>
</TABLE>
</BODY></HTML>
